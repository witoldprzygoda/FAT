#ifndef DATA_H
#define DATA_H

#include <TH1F.h>
#include <TH2F.h>
#include <TLorentzVector.h>
#include <TFile.h>
#include "src/hntuple.h"
#include "data.h"

inline Bool_t NoLeptonPip {false};
inline Bool_t NoHadronPip {false};
inline Bool_t NoLeptonP {false};
inline Bool_t NoHadronP {false};

inline Bool_t PiPlusProton;

/**
 * @brief Histogram definitions (pointers)
 * Defined in ObjectManager::initDataObjects
 */

inline TH1F *hp_p {nullptr};
inline TH1F *hp_theta {nullptr};
inline TH1F *hp_phi {nullptr};
inline TH2F *hp_theta_phi {nullptr};
inline TH2F *banana_pip {nullptr};
inline TH2F *banana_p {nullptr};

inline TH1F *mass_deltaPP {nullptr};
inline TH1F *mass_deltaP {nullptr};
inline TH1F *cos_theta_deltaPP {nullptr};
inline TH1F *cos_theta_deltaP {nullptr};
inline TH1F *cos_theta_p {nullptr};
inline TH1F *cos_theta_n {nullptr};
inline TH1F *mass_n {nullptr};
inline TH1F *mass_p {nullptr};
inline TH1F *mass_pip {nullptr};
inline TH1F *mass_n_tab[40] {nullptr};
inline TH1F *mass_p_tab[100] {nullptr};
inline TH1F *mass_nn_tab[40] {nullptr};
inline TH1F *mass_pp_tab[100] {nullptr};
inline TH1F *miss_mass_tab[25][20] {nullptr};

//

inline TH2F *exp_sig {nullptr};

// A
inline TH1F *pwa_pip_costh {nullptr};
inline TH1F *pwa_p_costh {nullptr};
inline TH1F *pwa_n_costh {nullptr};

// B
inline TH1F *pwa_pip_p {nullptr};
inline TH1F *pwa_p_p {nullptr};
inline TH1F *pwa_n_p {nullptr};

// C
inline TH1F *pwa_ppip_m {nullptr};
inline TH1F *pwa_npip_m {nullptr};
inline TH1F *pwa_pn_m {nullptr};

// D
inline TH1F *pwa_pip_helicity {nullptr};
inline TH1F *pwa_pipn_helicity {nullptr};
inline TH1F *pwa_n_helicity {nullptr};

// E
inline TH1F *pwa_pip_gj {nullptr};
inline TH1F *pwa_pipn_gj {nullptr};
inline TH1F *pwa_n_gj {nullptr};

inline TH1F *eVertX {nullptr}, *eVertY {nullptr}, *eVertZ {nullptr};

/**
 * @brief HNtuple pointer (writing TNtuple)
 * Defined in ObjectManager::initDataObjects
 */

inline HNtuple *nt {nullptr};

/**
 * @brief TLorentzVector pointers
 * Defined in ObjectManager::initDataObjects
 */

inline TLorentzVector *proj {nullptr}, *targ {nullptr}, *beam {nullptr};

inline TLorentzVector *pip {nullptr};
inline TLorentzVector *pip_LAB {nullptr};
inline TLorentzVector *p {nullptr};
inline TLorentzVector *p_LAB {nullptr};
inline TLorentzVector *n {nullptr};
inline TLorentzVector *n_LAB {nullptr};
inline TLorentzVector *deltaP {nullptr};
inline TLorentzVector *deltaP_LAB {nullptr};
inline TLorentzVector *deltaPP {nullptr};
inline TLorentzVector *deltaPP_LAB {nullptr};

inline TLorentzVector *p_pip {nullptr};
inline TLorentzVector *n_pip {nullptr};
inline TLorentzVector *pn {nullptr};
inline TLorentzVector *p_NPIP {nullptr};
inline TLorentzVector *n_PPIP {nullptr};
inline TLorentzVector *pip_PN {nullptr};
inline TLorentzVector *n_PN {nullptr};
inline TLorentzVector *pip_PPIP {nullptr};
inline TLorentzVector *pip_NPIP {nullptr};

inline TLorentzVector *proj_PPIP {nullptr};
inline TLorentzVector *proj_NPIP {nullptr};
inline TLorentzVector *proj_PN {nullptr};

/**
 * @brief Useful constants definitions
 */

inline const double D2R = 1.74532925199432955e-02;
inline const double R2D = 57.2957795130823229;

// **************** Q-factos (p pi+) ********************

inline double Qfactor_tab[25][20] = {
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // 1
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // 2
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // 3
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // 4
    {0.540892, 0.801986, 0.851193, 0.847033, 0.878351, 0.860063, 0.87631, 0.861172, 0.849455, 0.921999, 0.898816, 0.921708, 0.910619, 0.936937, 0.91029, 0.906845, 0.948574, 0, 0, 0}, // 5
    {0.770202, 0.902849, 0.909841, 0.919143, 0.906555, 0.909779, 0.893996, 0.890511, 0.877502, 0.886566, 0.85853, 0.876228, 0.881785, 0.905076, 0.84469, 0.869049, 0.860455, 0.786245, 0, 0}, // 6
    {0.999, 0.99778, 0.986064, 0.985725, 0.98364, 0.97921, 0.97465, 0.975987, 0.971868, 0.977047, 0.98336, 0.996638, 0.976746, 0.963503, 0.978158, 0.985752, 0.974808, 0.941673, 0, 0}, // 7
    {0.999, 0.998441, 0.99172, 0.992555, 0.989576, 0.982732, 0.985996, 0.981632, 0.996201, 0.987237, 0.975565, 0.986946, 0.984285, 0.978445, 0.987857, 0.991456, 0.987938, 0, 0, 0}, // 8
    {0.978801, 0.982226, 0.990083, 0.990648, 0.989355, 0.982168, 0.984791, 0.980772, 0.988807, 0.981699, 0.95706, 0.953062, 0.974606, 0.974163, 0.956806, 0.97299, 0.94816, 0.914109, 0.954635, 0}, // 9
    {0.978638, 0.980884, 0.986028, 0.991333, 0.98767, 0.978793, 0.981619, 0.973855, 0.983899, 0.987751, 0.979896, 0.966644, 0.971962, 0.959105, 0.951222, 0.941628, 0.976053, 0.954473, 0.836897, 0}, // 10
    {0.985628, 0.985417, 0.984087, 0.985718, 0.985561, 0.983807, 0.979911, 0.984533, 0.983106, 0.983484, 0.973764, 0.972146, 0.966111, 0.962365, 0.95986, 0.935751, 0.93105, 0.921809, 0.874377, 0.5}, // 11
    {0.994399, 0.990109, 0.982787, 0.987912, 0.986443, 0.978927, 0.98092, 0.98047, 0.978437, 0.989217, 0.969991, 0.970874, 0.960849, 0.957603, 0.953276, 0.949182, 0.944887, 0.960481, 0.945049, 0.895556}, // 12
    {0.989781, 0.989864, 0.987572, 0.988717, 0.987026, 0.985048, 0.983737, 0.987715, 0.981623, 0.983626, 0.979413, 0.979274, 0.973447, 0.974761, 0.972866, 0.970362, 0.973184, 0.980612, 0.968504, 0.943358}, // 13
    {0.987074, 0.98798, 0.988203, 0.984737, 0.984645, 0.981372, 0.982457, 0.977627, 0.977533, 0.976024, 0.9766, 0.979026, 0.973227, 0.975413, 0.967708, 0.977045, 0.976656, 0.975099, 0.962509, 0.958412}, // 14
    {0.987731, 0.985477, 0.980404, 0.978709, 0.978085, 0.973111, 0.970676, 0.972107, 0.972671, 0.968101, 0.968713, 0.962759, 0.964688, 0.965531, 0.957893, 0.963834, 0.967292, 0.974625, 0.970761, 0.964759}, // 15
    {0.985633, 0.986101, 0.984534, 0.985702, 0.98494, 0.981439, 0.981721, 0.977952, 0.980926, 0.976515, 0.981971, 0.971367, 0.972886, 0.972375, 0.971952, 0.975751, 0.980481, 0.976361, 0.973164, 0.971823}, // 16
    {0.988479, 0.989208, 0.990736, 0.990963, 0.987526, 0.989082, 0.988609, 0.987233, 0.987965, 0.98683, 0.989982, 0.978293, 0.980528, 0.978115, 0.980269, 0.985757, 0.986129, 0.983714, 0.974371, 0.982325}, // 17
    {0.981853, 0.982172, 0.981481, 0.980534, 0.981797, 0.976377, 0.978828, 0.971475, 0.974077, 0.968319, 0.969702, 0.971343, 0.964031, 0.971498, 0.975416, 0.979979, 0.981049, 0.976347, 0.974027, 0.977704}, // 18
    {0.983581, 0.984729, 0.987709, 0.985792, 0.982485, 0.990597, 0.990114, 0.984752, 0.979112, 0.977488, 0.981633, 0.979667, 0.979705, 0.980687, 0.974572, 0.988411, 0.983074, 0.986422, 0.973216, 0.97075}, // 19
    {0.984539, 0.981319, 0.984113, 0.98788, 0.981546, 0.988252, 0.979713, 0.990637, 0.985546, 0.984592, 0.985709, 0.975653, 0.981714, 0.983755, 0.983119, 0.983192, 0.983159, 0.977172, 0.974005, 0.979912}, // 20
    {0.977235, 0.976324, 0.977708, 0.976128, 0.977056, 0.972957, 0.968935, 0.972294, 0.965146, 0.965236, 0.962323, 0.965383, 0.962457, 0.955963, 0.953227, 0.952977, 0.95574, 0.95941, 0.943124, 0.95284}, // 21
    {0.978788, 0.974226, 0.975976, 0.980195, 0.972751, 0.973803, 0.97343, 0.971475, 0.967223, 0.991601, 0.962083, 0.962535, 0.962852, 0.960437, 0.95817, 0.962065, 0.955921, 0.955933, 0.94811, 0.951346}, // 22
    {0.990983, 0.986105, 0.991321, 0.991924, 0.993475, 0.992619, 0.989519, 0.990374, 0.988697, 0.98796, 0.989025, 0.990725, 0.986369, 0.987085, 0.989901, 0.988757, 0.983199, 0.981175, 0.991118, 0.983318}, // 23
    {0.980038, 0.981799, 0.980344, 0.978251, 0.987211, 0.983124, 0.980561, 0.982488, 0.9719, 0.992216, 0.989194, 0.987281, 0.989904, 0.98752, 0.970856, 0.972244, 0.966943, 0.964909, 0.964881, 0.960475}, // 24
    {0.986646, 0.988684, 0.986614, 0.992642, 0.993748, 0.989404, 0.982306, 0.985832, 0.989757, 0.995845, 0.992636, 0.970056, 0.967523, 0.968529, 0.970443, 0.968754, 0.968691, 0.963602, 0.964838, 0.967256}  // 25
};

/*
inline double Qfactor_tab[25][20] = {

    {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
    {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
    {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
    {1, 1, 1, 1, 0.0, 1, 0.0, 1, 1, 1, 1, 1, 1, 0, 1, 0.0, 0.0, 0.0, 0.0, 0.0},
    {0.9427, 0.9572, 0.9622, 0.9256, 0.8963, 0.893, 0.9351, 0.8474, 0.8773, 0.7326, 0.8425, 0.7907, 0.8821, 0.8793, 0.7805, 0.8698, 0.9487, 0.0, 0.0, 0.0},
    {0.9427, 0.9572, 0.9622, 0.9256, 0.8963, 0.9489, 0.933, 0.8474, 0.8773, 0.7326, 0.8425, 0.7907, 0.8821, 0.8793, 0.7805, 0.8308, 0.6373, 0.5, 0.0, 0.0},
    {0.9726, 0.9705, 0.9622, 0.9256, 0.9294, 0.9693, 0.8924, 0.9152, 0.8773, 0.8866, 0.8958, 0.8849, 0.9107, 0.8079, 0.7805, 0.9107, 0.8462, 0.462, 1, 0.0},
    {0.9752, 0.9673, 0.9705, 0.9536, 0.9733, 0.9636, 0.9693, 0.9152, 0.9523, 0.9078, 0.9168, 0.9375, 0.9107, 0.8971, 0.8992, 0.9107, 0.8443, 0.8, 0.8912, 0.0},
    {0.986, 0.9683, 0.9339, 0.9589, 0.969, 0.9572, 0.9564, 0.9152, 0.969, 0.9522, 0.9238, 0.9279, 0.9015, 0.8936, 0.9347, 0.9337, 0.9633, 0.9763, 0.9741, 0.5208},
    {0.9718, 0.9749, 0.9751, 0.9639, 0.9634, 0.9559, 0.9749, 0.9621, 0.9492, 0.9471, 0.9622, 0.9352, 0.9402, 0.933, 0.949, 0.9597, 0.9713, 0.9798, 0.9741, 0.9633},
    {0.974, 0.9785, 0.9614, 0.9744, 0.9691, 0.9367, 0.9711, 0.9682, 0.9531, 0.9598, 0.948, 0.9582, 0.9555, 0.9373, 0.9232, 0.9799, 0.9339, 0.9778, 0.9639, 0.9546},
    {0.978, 0.9768, 0.9706, 0.9718, 0.9673, 0.9592, 0.9678, 0.959, 0.9424, 0.916, 0.9342, 0.9582, 0.9607, 0.951, 0.9608, 0.9799, 0.9517, 0.9614, 0.9601, 0.9546},
    {0.977, 0.9705, 0.9631, 0.9703, 0.9594, 0.9323, 0.9391, 0.9457, 0.938, 0.9554, 0.9278, 0.9582, 0.944, 0.9467, 0.9553, 0.939, 0.9342, 0.975, 0.9632, 0.9452},
    {0.9694, 0.9619, 0.963, 0.9546, 0.9637, 0.9479, 0.9269, 0.9363, 0.9301, 0.9539, 0.91, 0.9252, 0.9659, 0.9386, 0.9471, 0.9577, 0.9598, 0.9729, 0.9475, 0.9758},
    {0.9577, 0.9393, 0.963, 0.9112, 0.9637, 0.9479, 0.933, 0.9363, 0.9301, 0.9539, 0.88, 0.9252, 0.9659, 0.9386, 0.9471, 0.9577, 0.9598, 0.9729, 0.95, 0.9758},
    {0.9557, 0.9418, 0.9316, 0.9118, 0.9637, 0.9479, 0.93, 0.9363, 0.9301, 0.9539, 0.88, 0.9252, 0.97, 0.9338, 0.95, 0.966, 0.95, 0.97, 0.95, 0.9758},
    {0.9456, 0.944, 0.9291, 0.9199, 0.9637, 0.9479, 0.93, 0.9363, 0.9301, 0.9539, 0.89, 0.9415, 0.97, 0.9338, 0.95, 0.966, 0.95, 0.97, 0.95, 0.9758},
    {0.9496, 0.9429, 0.9685, 0.9621, 0.9637, 0.95, 0.9534, 0.9468, 0.949, 0.9165, 0.92, 0.9415, 0.98, 0.9513, 0.95, 0.966, 0.95, 0.97, 0.96, 0.97},
    {0.9489, 0.9468, 0.9555, 0.9621, 0.9698, 0.9669, 0.9534, 0.9468, 0.949, 0.9326, 0.93, 0.9415, 0.9792, 0.9513, 0.95, 0.966, 0.9445, 0.97, 0.96, 0.97},
    {0.9322, 0.9632, 0.9577, 0.9619, 0.9698, 0.9669, 0.9534, 0.93, 0.949, 0.9378, 0.9499, 0.9415, 0.9792, 0.9513, 0.9659, 0.966, 0.9445, 0.97, 0.96, 0.97},
    {0.9729, 0.9654, 0.9773, 0.9619, 0.9698, 0.9669, 0.9534, 0.9361, 0.9355, 0.9378, 0.9499, 0.9415, 0.9631, 0.967, 0.9659, 0.9665, 0.9779, 0.96, 0.96, 0.94},
    {0.9623, 0.9643, 0.9836, 0.9534, 0.9742, 0.9669, 0.9718, 0.9631, 0.9263, 0.9378, 0.96, 0.9415, 0.9631, 0.967, 0.9487, 0.9497, 0.9779, 0.96, 0.9621, 0.94},
    {0.85, 0.9718, 0.9332, 0.95, 0.9742, 0.9706, 0.9718, 0.9631, 0.9925, 0.97, 0.9505, 0.98, 0.9631, 0.967, 0.98, 0.95, 0.9779, 0.975, 0.96, 0.9374},
    {0.85, 0.9718, 0.9332, 0.95, 0.94, 0.9706, 0.9718, 0.9631, 0.98, 0.97, 0.9545, 0.9415, 0.97, 0.967, 0.96, 0.95, 0.9779, 0.975, 0.96, 0.93},
    {0.8, 0.774, 0.8148, 0.8, 0.82, 0.9465, 0.9565, 0.9, 0.93, 0.93, 0.95, 0.93, 0.95, 0.967, 0.93, 0.9, 0.85, 0.8, 0.85, 0.4254}
};
*/


#endif // DATA_H
